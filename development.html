<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Development Page">


    <title>OpenMRS-Hypertension</title>

    <!-- Bootstrap core CSS -->
    <link href="dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Custom styles for this template -->
    <link href="css/tablestyle.css" rel="stylesheet" >
    <link href="css/carousel.css" rel="stylesheet">
    <link href="css/navbar-fixed-top.css" rel="stylesheet">
    <link href="css/landing-page.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">OpenMRS-Hypertension</a>
        </div>


        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Overview <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="initial_problem.html">Initial Problem</a></li>
                <li><a href="client.html">Client</a></li>
                <li><a href="requirement.html">Requirement</a></li>
              </ul>
            </li>
            

           <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Project Management<span class="caret"></span></a>
              <ul class="dropdown-menu">
                 <li><a href="project_management.html">Project Management</a></li>
                 <li><a href="workpackages.html">Work Packages</a></li>
                 <li><a href="biweekly_report.html">Biweekly Reports</a></li>
                 <li><a href="tools.html">Tools</a></li>
               </ul>
            </li>
            
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Research <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="research.html">Research</a></li>
                <li><a href="usecases.html">Use Cases</a></li>
                <li><a href="personas.html">User Personas</a></li>
              </ul>
            </li>
            
            <li><a href="design.html">Design</a></li>

            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Testing<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="testing_strategy.html">Testing Strategy</a></li>
                <li><a href="testing.html">Testing</a></li>
              </ul>
            </li>

            
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Development <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="development.html">Achievements & Implementation Details</a></li>
                <li><a href="system.html">Architectural Diagrams</a></li>
                <li><a href="designpatterns.html">Design Patterns</a></li>
                <li><a href="evaluation.html">Evaluation</a></li>
                <li><a href="deployment.html">Deployment</a></li>
                <li><a href="future_development.html">Future Developments</a></li>
              </ul>
            </li>

            <li><a href="manual.html">Manual</a></li>
                        
            <li><a href="https://github.com/DianaD96/Team13AndroidClient"><i class="fa fa-github fa-fw"></i>GitHub</a></li>

            <li><a href="http://group13.freeforums.org/">Forum</a></li>
                        
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>


    <!-- Page Content -->

<div class="content-section-a-height">

        <div class="container">
            <div class="row">
                <div class="col-lg-10 col-sm-6 col-lg-offset-1">
                
                    <h2 class="content-heading">Project Development</h2>

                    <div class="col-lg">
                    <h2 class="subheading-color">Technical Achievement</h2>
                     <hr class="section-spacer-line">
                    </div>
                    
                    <p class="paragraph-description"> Listed below are the technical achievement the team has achieved over the development of the project.</p>
                    <li class="paragraph-list"> Setting up OpenMRS platform on individual computer and Bupa Server </li>
                    <li class="paragraph-list"> Posting and receiving data from OpenMRS server to and fro mobile app </li>
                    <li class="paragraph-list"> Implementing local database for offline viewing </li>
                    <li class="paragraph-list"> GoogleFit API integration </li>
                    <li class="paragraph-list"> Fitbit API integration </li>
                    <li class="paragraph-list"> FatSecret API integration </li>
                    <li class="paragraph-list"> Graph visualization</li>
                    <li class="paragraph-list"> Health data analytics
                    <li class="paragraph-list"> Chat messaging and notification </li>

           
                    


                    <div class="col-lg">
                      <h2 class="subheading-color" style="padding-top:30px">Implementation Details</h2>
                       <hr class="section-spacer-line">            
                    </div>

                    <p class="paragraph-description"> SyncData - Fitbit Authentication implementation </p>
                    <p class="paragraph-smaller-description"> Fitbit Authentication carried out by ChromeTab and once user has authenticate, they will be redirected back to app via callback url and intent filter. </p>
                    <table style="text-align:left">
                              <thead>
                                  <tr >
                                      <td style="background-color:#b8cce4">Steps</th>
                                      <td style="background-color:#b8cce4">Details</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                    <td> 1 </td>
                                    <td> Implementation of Chrome Custom Tabs to allow user to access Fitbit Authentication page </td>
                                  </tr>
                                  <tr>
                                    <td> 2 </td>
                                    <td> User will be asked to login to their Fitbit account and allow our app to view their data </td>
                                  </tr>
                                  <tr>
                                    <td> 3 </td>
                                    <td> Upon user consent, user will be redirected back to our app by a redirect url (openmrs://logincallback ) </td>
                                  </tr>
                                  <tr>
                                    <td> 4 </td>
                                    <td> An intent filter (SyncFitbitAuthorization class) has been set up in our app to capture the redirect url from Fitbit </td>
                                  </tr>
                                  <tr>
                                    <td> 5 </td>
                                    <td> Redirect URL contains authorization code which we will extract and save in our app </td>
                                  </tr>
                                  <tr>
                                    <td> 6 </td>
                                    <td> A request is sent to Fitbit with the user Authorization code to exchange for an access and refresh token </td>
                                  </tr>
                                  <tr>
                                    <td> 7 </td>
                                    <td> The Fitbit response is then transformed into a JSON object to extract the access and refresh token to be saved to the app </td>
                                  </tr>
                                  <tr>
                                    <td> 8 </td>
                                    <td> User can now pull their own Fitbit data by clicking "Sync Fitbit" button on SyncData page. </td>
                                  </tr>
                                  <tr>
                                    <td> 9 </td>
                                    <td> When Sync Fitbit button is clicked, the SyncFitbitService will be called (See SyncFitbitService implementation details) </td>
                                  </tr>
                              </tbody>
                    </table>

                     <hr class="section-spacer-line">      
                     <p class="paragraph-description"> SyncFitbitService implementation</p>
                     <p class="paragraph-smaller-description"> Automatically download appropriate Fitbit data and upload it to OpenMRS server, followed by checking the data from OpenMRS and saving it to app local database </p>

                    <table style="text-align:left">
                              <thead>
                                  <tr >
                                      <td style="background-color:#b8cce4">Steps</th>
                                      <td style="background-color:#b8cce4">Details</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                    <td> 1 </td>
                                    <td> An array of String containing the activities (activity, heartRate, food, sleep ) URL is initiated. </td>
                                  </tr>
                                  <tr>
                                    <td> 2 </td>
                                    <td> The String array is passed as a parameter to getUserData method which uses a for loop to loop through the activities and requesting data from Fitbit. (This is needed because Fitbit doesn't provide all the needed data under one URL request )</td>
                                  </tr>
                                  <tr>
                                    <td> 3 </td>
                                    <td> The individual response from each activities is converted into a JSON Object which is then passed to "getFitbitData" method which extracts the necessary data that our app requires and stores it in a variable which will be used to upload to the OpenMRS server.</td>
                                  </tr>
                                  <tr>
                                    <td> 4 </td>
                                    <td> Once all the needed data has been extracted, the "syncFitBit" method is called to check if the data from FItbit is correct before uploading it to the OpenMRS server</td>
                                  </tr>
                                  <tr>
                                    <td> 5 </td>
                                    <td> The SyncGraphService service is called to download the data from OpenMRS to our local database ( Data downloaded from OpenMRS instead of using the data from Fitbit because the data might be different as there are other way of uploading data to OpenMRS server as well [ GoogleFit and Manual input ].) </td>
                                  </tr>
                            </tbody>
                    </table>

                    <hr class="section-spacer-line">
                    <p class="paragraph-description"> SyncGraphService implementation </p>
                    <p class="paragraph-smaller-description"> Downloads data from OpenMRS server, process it and then stores it into app local database </p>
            

                      <table style="text-align:left">
                              <thead>
                                  <tr >
                                      <td style="background-color:#b8cce4">Steps</th>
                                      <td style="background-color:#b8cce4">Details</th>
                                  </tr>
                              </thead>
                              <tbody>

                                  <tr>
                                    <td> 1 </td>
                                    <td> Array of String, Dates and GraphData are initialised which will be used to store the data obtained from OpenMRS over the past 5 days </td>
                                  </tr>
                                  <tr>
                                    <td> 2 </td>
                                    <td> "pullData" function is called which takes in the array of dates (past 5 days), and the REST GET response from OpenMRS containing the user's data. The function then check the response for observations we require (heart rate, steps, etc..) and calls the "checkExerciseDate" function.  </td>
                                  </tr>
                                  <tr>
                                    <td> 3 </td>
                                    <td> The "checkExerciseDate" function checks the response if it matches the dates we are looking for (past 5 days), and if it does it will store the data into the GraphData object.</td>
                                  </tr>
                                  <tr>
                                    <td> 4 </td>
                                    <td> Array of GraphData is then inserted/updated into the local database according to dates.</td>
                                  </tr>
                              </tbody>
                      </table> 

                    <hr class="section-spacer-line">
                    <p class="paragraph-description" style="margin-bottom:-20px"> SyncData - GoogleFit Authentication implementation  </p>

                    <table style="text-align:left">
                              <thead>
                                  <tr>
                                      <td style="background-color:#b8cce4">Steps</th>
                                      <td style="background-color:#b8cce4">Details</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                    <td> 1 </td>
                                    <td> First time user will be asked to choose the Google Account they used for Google Fit in a pop up dialog. </td>
                                  </tr>
                                  <tr>
                                    <td> 2 </td>
                                    <td> This allows the app to connect to Fitness APIs.</td>
                                  </tr>
                                  <tr>
                                    <td> 3 </td>
                                    <td> The app will automatically invoke readings of Step count and Calories data using Fitness APIs.</td>
                                  </tr>
                                  <tr>
                                    <td> 4 </td>
                                    <td> Readings will be displayed in an edit box above the sync button.</td>
                                  </tr>
                              </tbody>
                      </table>    

					<hr class="section-spacer-line">
                    <p class="paragraph-description"> SyncGoogleFitService implementation </p>
                    <p class="paragraph-smaller-description"> Automatically download GoogleFit data and upload it to OpenMRS server </p>
					
					<table style="text-align:left">
                              <thead>
                                  <tr>
                                      <td style="background-color:#b8cce4">Steps</th>
                                      <td style="background-color:#b8cce4">Details</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                    <td> 1 </td>
                                    <td> Two strings are initiated containing results of Step count and Calories from GoogleFit, user UUID, date and concept UUID. </td>
                                  </tr>
                                  <tr>
                                    <td> 2 </td>
                                    <td> Results are obtained by calling getStep() and getCal() methods from SyncData respectively that invoke the Fitness APIs and extract the raw data. </td>
                                  </tr>
                                  <tr>
                                    <td> 3 </td>
                                    <td> SyncGoogleFit method will submit the following strings to the OpenMRS database and return true in the info log if it succeed or an error otherwise.</td>
                                  </tr>
                              </tbody>
                    </table>
					
					<hr class="section-spacer-line">
                    <p class="paragraph-description"> NotifyService implementation </p>
                    <p class="paragraph-smaller-description"> Issue a notification when there’s a new chat message from the doctor while user is not currently on the chat page </p>
					
					<table style="text-align:left">
                              <thead>
                                  <tr>
                                      <td style="background-color:#b8cce4">Steps</th>
                                      <td style="background-color:#b8cce4">Details</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                    <td> 1 </td>
                                    <td> An alarm manager is initiated when user first launch the app that is set to repeat every minute. </td>
                                  </tr>
                                  <tr>
                                    <td> 2 </td>
                                    <td> AlarmManagerService would then invoke the NotifyService to run in the background. </td>
                                  </tr>
                                  <tr>
                                    <td> 3 </td>
                                    <td> checkForNewMessage() would issue a POST request to OpenMRS server to check for the latest message from the doctor.</td>
                                  </tr>
								  <tr>
                                    <td> 4 </td>
                                    <td> obsDatetime of latest message on the server is used to check again a date variable, if obsDatetime is newer than the date variable then issue a notification.</td>
                                  </tr>
								  <tr>
                                    <td> 5 </td>
                                    <td> The date variable is updated everytime a notification is issued or when chat activity is alive to avoid repetitions.</td>
                                  </tr>
                              </tbody>
                    </table>


                    <hr class="section-spacer-line">
                    <p class="paragraph-description">SearchFood - FatSecret API Implementation</p>
                    <p class="paragraph-smaller-description">Allows the user to manually search for any type of food </p>
					
					<table style="text-align:left">
                              <thead>
                                  <tr>
                                      <td style="background-color:#b8cce4">Steps</th>
                                      <td style="background-color:#b8cce4">Details</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  <tr>
                                    <td> 1 </td>
                                    <td> The user is automatically logged in where the OAuth authentication is done using the token key and and secret key provided in the FatSecretUtils.java. </td>
                                  </tr>
                                  <tr>
                                    <td> 2 </td>
                                    <td> Searching for the specific food the user has requested is done in the search() method where a GET request is called onto the FatSecret server containing as a parameter the name of the food the user has typed in. </td>
                                  </tr>
                                  <tr>
                                    <td> 3 </td>
                                    <td> Displaying the response from the server is done in the displayListView() method where an arrayAdapter is used to populate the listView which will be displayed on the screen.</td>
                                  </tr>
                              </tbody>
                    </table>
					

                        
                </div>
             </div>    
        </div>
        <!-- /.container -->

    </div>


      <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <ul class="list-inline">
              <li>
                <a href="index.html">Home</a>
              </li>
            
              <li class="pull-right">
                <a href="#">Back to top</a>
              </li>
            </ul>
          
            <ul class="list-inline">
              <li class="copyright text-muted small">Copyright &copy; System Engineering Project Team 13</li>
            </ul>
          </div>
        </div>
      </div>
    </footer>


    <!-- jQuery -->
    <script src="assets/js/jquery.js"></script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="dist/js/bootstrap.min.js"></script>
    <!-- Just to make our placeholder images work. Don't actually copy the next line! -->
    <script src="assets/js/vendor/holder.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="assets/js/ie10-viewport-bug-workaround.js"></script>

</body>

</html>
